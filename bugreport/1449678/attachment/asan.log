==53596==ERROR: AddressSanitizer: heap-use-after-free on address 0x126975b7b330 at pc 0x7ff92d7b1500 bp 0x007b091fb020 sp 0x007b091fb068
READ of size 8 at 0x126975b7b330 thread T0
    #0 0x7ff92d7b14ff in std::__Cr::__packaged_task_func<`lambda at ..\..\components\media_router\common\providers\cast\channel\libcast_socket_service.cc:93:11',std::__Cr::allocator<`lambda at ..\..\components\media_router\common\providers\cast\channel\libcast_socket_service.cc:93:11'>,void ()>::operator() D:\project\chromium\src\buildtools\third_party\libc++\trunk\include\future:1705
    #1 0x7ff9222e99e7 in std::__Cr::packaged_task<void ()>::operator() D:\project\chromium\src\buildtools\third_party\libc++\trunk\include\future:2093
    #2 0x7ff9222e94de in openscreen_platform::`anonymous namespace'::ExecuteTask D:\project\chromium\src\components\openscreen_platform\task_runner.cc:23
    #3 0x7ff9222e9f5a in base::internal::FunctorTraits<void (*)(std::__Cr::packaged_task<void ()>),void>::Invoke<void (*)(std::__Cr::packaged_task<void ()>),std::__Cr::packaged_task<void ()> > D:\project\chromium\src\base\functional\bind_internal.h:636
    #4 0x7ff9222e9ce4 in base::internal::Invoker<base::internal::BindState<void (*)(std::__Cr::packaged_task<void ()>),std::__Cr::packaged_task<void ()> >,void ()>::RunOnce D:\project\chromium\src\base\functional\bind_internal.h:976
    #5 0x7ff93557a9c6 in base::TaskAnnotator::RunTaskImpl D:\project\chromium\src\base\task\common\task_annotator.cc:186
    #6 0x7ff9355e3acb in base::sequence_manager::internal::ThreadControllerWithMessagePumpImpl::DoWorkImpl D:\project\chromium\src\base\task\sequence_manager\thread_controller_with_message_pump_impl.cc:486
    #7 0x7ff9355e285f in base::sequence_manager::internal::ThreadControllerWithMessagePumpImpl::DoWork D:\project\chromium\src\base\task\sequence_manager\thread_controller_with_message_pump_impl.cc:351
    #8 0x7ff935743bf0 in base::MessagePumpForUI::DoRunLoop D:\project\chromium\src\base\message_loop\message_pump_win.cc:211
    #9 0x7ff9357415f6 in base::MessagePumpWin::Run D:\project\chromium\src\base\message_loop\message_pump_win.cc:77
    #10 0x7ff9355e627f in base::sequence_manager::internal::ThreadControllerWithMessagePumpImpl::Run D:\project\chromium\src\base\task\sequence_manager\thread_controller_with_message_pump_impl.cc:651
    #11 0x7ff9354e2927 in base::RunLoop::Run D:\project\chromium\src\base\run_loop.cc:134
    #12 0x7ff918ed45fe in content::BrowserMainLoop::RunMainMessageLoop D:\project\chromium\src\content\browser\browser_main_loop.cc:1067
    #13 0x7ff918edc4bd in content::BrowserMainRunnerImpl::Run D:\project\chromium\src\content\browser\browser_main_runner_impl.cc:158
    #14 0x7ff918ecc493 in content::BrowserMain D:\project\chromium\src\content\browser\browser_main.cc:34
    #15 0x7ff91bb4647c in content::RunBrowserProcessMain D:\project\chromium\src\content\app\content_main_runner_impl.cc:707
    #16 0x7ff91bb4a71e in content::ContentMainRunnerImpl::RunBrowser D:\project\chromium\src\content\app\content_main_runner_impl.cc:1284
    #17 0x7ff91bb49ead in content::ContentMainRunnerImpl::Run D:\project\chromium\src\content\app\content_main_runner_impl.cc:1138
    #18 0x7ff91bb44224 in content::RunContentProcess D:\project\chromium\src\content\app\content_main.cc:326
    #19 0x7ff91bb44ed0 in content::ContentMain D:\project\chromium\src\content\app\content_main.cc:343
    #20 0x7ff920ce1733 in ChromeMain D:\project\chromium\src\chrome\app\chrome_main.cc:187
    #21 0x7ff6e22a5e05 in MainDllLoader::Launch D:\project\chromium\src\chrome\app\main_dll_loader_win.cc:166
    #22 0x7ff6e22a2a85 in main D:\project\chromium\src\chrome\app\chrome_exe_main_win.cc:390
    #23 0x7ff6e245e793 in __scrt_common_main_seh D:\a\_work\1\s\src\vctools\crt\vcstartup\src\startup\exe_common.inl:288
    #24 0x7ff98f537033 in BaseThreadInitThunk+0x13 (C:\Windows\System32\KERNEL32.DLL+0x180017033)
    #25 0x7ff991362650 in RtlUserThreadStart+0x20 (C:\Windows\SYSTEM32\ntdll.dll+0x180052650)

0x126975b7b330 is located 64 bytes inside of 112-byte region [0x126975b7b2f0,0x126975b7b360)
freed by thread T11 here:
    #0 0x7ff933c6ef7d in operator delete+0x8d (D:\project\chromium\src\out\asan-release\clang_rt.asan_dynamic-x86_64.dll+0x18004ef7d)
    #1 0x7ff92d7b0047 in cast_channel::CastSocketWrapper::~CastSocketWrapper D:\project\chromium\src\components\media_router\common\providers\cast\channel\libcast_socket_service.cc:121
    #2 0x7ff92b11088c in base::internal::Invoker<base::internal::BindState<base::internal::IgnoreResultHelper<std::__Cr::unique_ptr<cast_channel::CastSocket,std::__Cr::default_delete<cast_channel::CastSocket> > (cast_channel::CastSocketService::*)(int)>,base::internal::UnretainedWrapper<cast_channel::CastSocketService,base::unretained_traits::MayNotDangle,0>,int>,void ()>::RunOnce D:\project\chromium\src\base\functional\bind_internal.h:976
    #3 0x7ff93557a9c6 in base::TaskAnnotator::RunTaskImpl D:\project\chromium\src\base\task\common\task_annotator.cc:186
    #4 0x7ff9355e3acb in base::sequence_manager::internal::ThreadControllerWithMessagePumpImpl::DoWorkImpl D:\project\chromium\src\base\task\sequence_manager\thread_controller_with_message_pump_impl.cc:486
    #5 0x7ff9355e285f in base::sequence_manager::internal::ThreadControllerWithMessagePumpImpl::DoWork D:\project\chromium\src\base\task\sequence_manager\thread_controller_with_message_pump_impl.cc:351
    #6 0x7ff9357482f2 in base::MessagePumpForIO::DoRunLoop D:\project\chromium\src\base\message_loop\message_pump_win.cc:713
    #7 0x7ff9357415f6 in base::MessagePumpWin::Run D:\project\chromium\src\base\message_loop\message_pump_win.cc:77
    #8 0x7ff9355e627f in base::sequence_manager::internal::ThreadControllerWithMessagePumpImpl::Run D:\project\chromium\src\base\task\sequence_manager\thread_controller_with_message_pump_impl.cc:651
    #9 0x7ff9354e2927 in base::RunLoop::Run D:\project\chromium\src\base\run_loop.cc:134
    #10 0x7ff93568536d in base::Thread::Run D:\project\chromium\src\base\threading\thread.cc:342
    #11 0x7ff918ee10f3 in content::BrowserProcessIOThread::IOThreadRun D:\project\chromium\src\content\browser\browser_process_io_thread.cc:119
    #12 0x7ff935685833 in base::Thread::ThreadMain D:\project\chromium\src\base\threading\thread.cc:414
    #13 0x7ff935780261 in base::`anonymous namespace'::ThreadFunc D:\project\chromium\src\base\threading\platform_thread_win.cc:133
    #14 0x7ff933c6c335 in _asan_default_suppressions__dll+0x13d5 (D:\project\chromium\src\out\asan-release\clang_rt.asan_dynamic-x86_64.dll+0x18004c335)
    #15 0x7ff98f537033 in BaseThreadInitThunk+0x13 (C:\Windows\System32\KERNEL32.DLL+0x180017033)
    #16 0x7ff991362650 in RtlUserThreadStart+0x20 (C:\Windows\SYSTEM32\ntdll.dll+0x180052650)

previously allocated by thread T11 here:
    #0 0x7ff933c6e75d in operator new+0x8d (D:\project\chromium\src\out\asan-release\clang_rt.asan_dynamic-x86_64.dll+0x18004e75d)
    #1 0x7ff92d7a7f4f in cast_channel::LibcastSocketService::OnConnectedIOThread D:\project\chromium\src\components\media_router\common\providers\cast\channel\libcast_socket_service.cc:377
    #2 0x7ff92d7acba7 in base::internal::Invoker<base::internal::BindState<void (cast_channel::LibcastSocketService::*)(openscreen::cast::SenderSocketFactory *, const openscreen::IPEndpoint &, std::__Cr::unique_ptr<openscreen::cast::CastSocket,std::__Cr::default_delete<openscreen::cast::CastSocket> >),base::internal::UnretainedWrapper<cast_channel::LibcastSocketService,base::unretained_traits::MayNotDangle,0>,base::internal::UnretainedWrapper<openscreen::cast::SenderSocketFactory,base::unretained_traits::MayNotDangle,0>,openscreen::IPEndpoint,std::__Cr::unique_ptr<openscreen::cast::CastSocket,std::__Cr::default_delete<openscreen::cast::CastSocket> > >,void ()>::RunOnce D:\project\chromium\src\base\functional\bind_internal.h:976
    #3 0x7ff93557a9c6 in base::TaskAnnotator::RunTaskImpl D:\project\chromium\src\base\task\common\task_annotator.cc:186
    #4 0x7ff9355e3acb in base::sequence_manager::internal::ThreadControllerWithMessagePumpImpl::DoWorkImpl D:\project\chromium\src\base\task\sequence_manager\thread_controller_with_message_pump_impl.cc:486
    #5 0x7ff9355e285f in base::sequence_manager::internal::ThreadControllerWithMessagePumpImpl::DoWork D:\project\chromium\src\base\task\sequence_manager\thread_controller_with_message_pump_impl.cc:351
    #6 0x7ff9357482f2 in base::MessagePumpForIO::DoRunLoop D:\project\chromium\src\base\message_loop\message_pump_win.cc:713
    #7 0x7ff9357415f6 in base::MessagePumpWin::Run D:\project\chromium\src\base\message_loop\message_pump_win.cc:77
    #8 0x7ff9355e627f in base::sequence_manager::internal::ThreadControllerWithMessagePumpImpl::Run D:\project\chromium\src\base\task\sequence_manager\thread_controller_with_message_pump_impl.cc:651
    #9 0x7ff9354e2927 in base::RunLoop::Run D:\project\chromium\src\base\run_loop.cc:134
    #10 0x7ff93568536d in base::Thread::Run D:\project\chromium\src\base\threading\thread.cc:342
    #11 0x7ff918ee10f3 in content::BrowserProcessIOThread::IOThreadRun D:\project\chromium\src\content\browser\browser_process_io_thread.cc:119
    #12 0x7ff935685833 in base::Thread::ThreadMain D:\project\chromium\src\base\threading\thread.cc:414
    #13 0x7ff935780261 in base::`anonymous namespace'::ThreadFunc D:\project\chromium\src\base\threading\platform_thread_win.cc:133
    #14 0x7ff933c6c335 in _asan_default_suppressions__dll+0x13d5 (D:\project\chromium\src\out\asan-release\clang_rt.asan_dynamic-x86_64.dll+0x18004c335)
    #15 0x7ff98f537033 in BaseThreadInitThunk+0x13 (C:\Windows\System32\KERNEL32.DLL+0x180017033)
    #16 0x7ff991362650 in RtlUserThreadStart+0x20 (C:\Windows\SYSTEM32\ntdll.dll+0x180052650)

Thread T11 created by T0 here:
    #0 0x7ff933c6df82 in _asan_wrap_CreateThread+0x62 (D:\project\chromium\src\out\asan-release\clang_rt.asan_dynamic-x86_64.dll+0x18004df82)
    #1 0x7ff93577f0cf in base::`anonymous namespace'::CreateThreadInternal D:\project\chromium\src\base\threading\platform_thread_win.cc:198
    #2 0x7ff935683dc1 in base::Thread::StartWithOptions D:\project\chromium\src\base\threading\thread.cc:215
    #3 0x7ff91a3d93b9 in content::BrowserTaskExecutor::CreateIOThread D:\project\chromium\src\content\browser\scheduler\browser_task_executor.cc:301
    #4 0x7ff91bb4af2b in content::ContentMainRunnerImpl::RunBrowser D:\project\chromium\src\content\app\content_main_runner_impl.cc:1254
    #5 0x7ff91bb49ead in content::ContentMainRunnerImpl::Run D:\project\chromium\src\content\app\content_main_runner_impl.cc:1138
    #6 0x7ff91bb44224 in content::RunContentProcess D:\project\chromium\src\content\app\content_main.cc:326
    #7 0x7ff91bb44ed0 in content::ContentMain D:\project\chromium\src\content\app\content_main.cc:343
    #8 0x7ff920ce1733 in ChromeMain D:\project\chromium\src\chrome\app\chrome_main.cc:187
    #9 0x7ff6e22a5e05 in MainDllLoader::Launch D:\project\chromium\src\chrome\app\main_dll_loader_win.cc:166
    #10 0x7ff6e22a2a85 in main D:\project\chromium\src\chrome\app\chrome_exe_main_win.cc:390
    #11 0x7ff6e245e793 in __scrt_common_main_seh D:\a\_work\1\s\src\vctools\crt\vcstartup\src\startup\exe_common.inl:288
    #12 0x7ff98f537033 in BaseThreadInitThunk+0x13 (C:\Windows\System32\KERNEL32.DLL+0x180017033)
    #13 0x7ff991362650 in RtlUserThreadStart+0x20 (C:\Windows\SYSTEM32\ntdll.dll+0x180052650)

SUMMARY: AddressSanitizer: heap-use-after-free D:\project\chromium\src\buildtools\third_party\libc++\trunk\include\future:1705 in std::__Cr::__packaged_task_func<`lambda at ..\..\components\media_router\common\providers\cast\channel\libcast_socket_service.cc:93:11',std::__Cr::allocator<`lambda at ..\..\components\media_router\common\providers\cast\channel\libcast_socket_service.cc:93:11'>,void ()>::operator()
Shadow bytes around the buggy address:
  0x126975b7b080: fa fa fa fa fa fa fa fa fa fa f7 fa fa fa fa fa
  0x126975b7b100: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x126975b7b180: f7 fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x126975b7b200: fa fa fa fa fa fa f7 fa fd fd fd fd fd fd fd fd
  0x126975b7b280: fd fd fd fd fd fd fa fa fa fa fa fa f7 fa fd fd
=>0x126975b7b300: fd fd fd fd fd fd[fd]fd fd fd fd fd fa fa fa fa
  0x126975b7b380: fa fa f7 fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x126975b7b400: fa fa fa fa fa fa fa fa f7 fa fa fa fa fa fa fa
  0x126975b7b480: fa fa fa fa fa fa fa fa fa fa fa fa fa fa f7 fa
  0x126975b7b500: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x126975b7b580: fa fa fa fa f7 fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb

==53596==ADDITIONAL INFO

==53596==Note: Please include this section with the ASan report.
Task trace:
    #0 0x7ff9222e936e in openscreen_platform::TaskRunner::PostPackagedTask D:\project\chromium\src\components\openscreen_platform\task_runner.cc:34
    #1 0x7ff92d7eb55a in cast_channel::KeepAliveHandler::Start D:\project\chromium\src\components\media_router\common\providers\cast\channel\keep_alive_handler.cc:66
    #2 0x7ff92d7a9893 in cast_channel::LibcastSocketService::OnMessage D:\project\chromium\src\components\media_router\common\providers\cast\channel\libcast_socket_service.cc:303
    #3 0x7ff93fefa3c4 in mojo::SimpleWatcher::Context::Notify D:\project\chromium\src\mojo\public\cpp\system\simple_watcher.cc:102


MiraclePtr Status: NOT PROTECTED
No raw_ptr<T> access to this region was detected prior to this crash.
This crash is still exploitable with MiraclePtr.
Refer to https://chromium.googlesource.com/chromium/src/+/main/base/memory/raw_ptr.md for details.

==53596==END OF ADDITIONAL INFO
==53596==ABORTING